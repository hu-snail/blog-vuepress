<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Taro自定义组件封装 | hu-snail</title>
    <meta name="description" content="前端笔记，前端资源，前端学习，vue,react,node,小程序">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/blog-vuepress/assets/css/0.styles.6d9b3c99.css" as="style"><link rel="preload" href="/blog-vuepress/assets/js/app.ed3613a2.js" as="script"><link rel="preload" href="/blog-vuepress/assets/js/24.2c8d5321.js" as="script"><link rel="prefetch" href="/blog-vuepress/assets/js/10.fb379171.js"><link rel="prefetch" href="/blog-vuepress/assets/js/11.90a4cc0d.js"><link rel="prefetch" href="/blog-vuepress/assets/js/12.79d1bafe.js"><link rel="prefetch" href="/blog-vuepress/assets/js/13.16ef4e75.js"><link rel="prefetch" href="/blog-vuepress/assets/js/14.e1933095.js"><link rel="prefetch" href="/blog-vuepress/assets/js/15.172b486c.js"><link rel="prefetch" href="/blog-vuepress/assets/js/16.b286ae31.js"><link rel="prefetch" href="/blog-vuepress/assets/js/17.ab583289.js"><link rel="prefetch" href="/blog-vuepress/assets/js/18.ba9a26fc.js"><link rel="prefetch" href="/blog-vuepress/assets/js/19.dddb6a37.js"><link rel="prefetch" href="/blog-vuepress/assets/js/20.4ad8113b.js"><link rel="prefetch" href="/blog-vuepress/assets/js/21.763404bc.js"><link rel="prefetch" href="/blog-vuepress/assets/js/22.13158646.js"><link rel="prefetch" href="/blog-vuepress/assets/js/23.23ec5b2a.js"><link rel="prefetch" href="/blog-vuepress/assets/js/25.1c531617.js"><link rel="prefetch" href="/blog-vuepress/assets/js/26.a70fb357.js"><link rel="prefetch" href="/blog-vuepress/assets/js/27.11b7b0a4.js"><link rel="prefetch" href="/blog-vuepress/assets/js/28.47c7c5c7.js"><link rel="prefetch" href="/blog-vuepress/assets/js/3.ff1c62c3.js"><link rel="prefetch" href="/blog-vuepress/assets/js/4.aa6240a3.js"><link rel="prefetch" href="/blog-vuepress/assets/js/5.3ed8be1a.js"><link rel="prefetch" href="/blog-vuepress/assets/js/6.e4bb391e.js"><link rel="prefetch" href="/blog-vuepress/assets/js/7.1a194194.js"><link rel="prefetch" href="/blog-vuepress/assets/js/8.afaba030.js"><link rel="prefetch" href="/blog-vuepress/assets/js/9.a6c408be.js"><link rel="prefetch" href="/blog-vuepress/assets/js/vendors~docsearch.a7f03cda.js">
    <link rel="stylesheet" href="/blog-vuepress/assets/css/0.styles.6d9b3c99.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><div><header id="navbarWrapper" class="navbar"><div class="sidebar-button"><i class="iconfont reco-menu"></i></div> <a href="/blog-vuepress/" class="home-link router-link-active"><!----> <span class="site-name">hu-snail</span></a> <div class="links" style="max-width:nullpx;"><div class="side-search-wrapper"><div class="search-box" data-v-1b2e3b29><input aria-label="Search" autocomplete="off" spellcheck="false" value="" data-v-1b2e3b29> <i class="iconfont reco-search" data-v-1b2e3b29></i> <!----></div></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog-vuepress/pages/tags/" class="nav-link"><i class="iconfont undefined"></i>
  笔记标签
</a></div><div class="nav-item"><a href="/blog-vuepress/pages/links/" class="nav-link"><i class="iconfont undefined"></i>
  前端资源
</a></div><div class="nav-item"><a href="/blog-vuepress/pages/study/" class="nav-link"><i class="iconfont undefined"></i>
  前端学习
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><div class="side-search-wrapper"><div class="search-box" data-v-1b2e3b29><input aria-label="Search" autocomplete="off" spellcheck="false" value="" data-v-1b2e3b29> <i class="iconfont reco-search" data-v-1b2e3b29></i> <!----></div></div> <nav class="nav-links"><div class="nav-item"><a href="/blog-vuepress/pages/tags/" class="nav-link"><i class="iconfont undefined"></i>
  笔记标签
</a></div><div class="nav-item"><a href="/blog-vuepress/pages/links/" class="nav-link"><i class="iconfont undefined"></i>
  前端资源
</a></div><div class="nav-item"><a href="/blog-vuepress/pages/study/" class="nav-link"><i class="iconfont undefined"></i>
  前端学习
</a></div> <!----></nav>  <!----> </div> <div class="page" data-v-cdcae5a4> <div class="page-title" data-v-cdcae5a4><h1 data-v-cdcae5a4>Taro自定义组件封装</h1> <hr data-v-cdcae5a4> <div data-v-2c25cede data-v-cdcae5a4><i class="iconfont reco-account" data-v-2c25cede><span data-v-2c25cede>hu-snail</span></i> <i class="iconfont reco-date" data-v-2c25cede><span data-v-2c25cede>2019-6-26</span></i> <!----> <i class="iconfont reco-tag tags" data-v-2c25cede><span class="tag-item" data-v-2c25cede>
      taro taro ui
    </span></i></div></div> <div class="content" data-v-cdcae5a4><p>参考案列：图片上传</p> <div class="warning custom-block"><p class="custom-block-title">注意</p> <p>需要注意的点：组件类名称为了不与<code>Taro</code> , <code>TaroUI</code>, <code>WX</code>自带的标签名字冲突，本项目中自定义的组件需要添加<code>S</code>,如：export default class <code>SImage</code> extends Component {}
<code>prop-types</code>:  '^15.7.2' 组件参数类型
命令：<code>npm install prop-types --save</code></p></div> <h2 id="创建组件"><a href="#创建组件" aria-hidden="true" class="header-anchor">#</a> 创建组件</h2> <p>路径： <code>src/components/upload/image.js</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> Taro<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@tarojs/taro'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> View <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@tarojs/components'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> AtImagePicker <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'taro-ui'</span>
<span class="token keyword">import</span> PropTypes <span class="token keyword">from</span> <span class="token string">'prop-types'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> http <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../../config'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token constant">RES_STATUS</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../../constant'</span>
<span class="token comment">// 图片上传组件</span>
<span class="token keyword">class</span> <span class="token class-name">SImage</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> SImage

</code></pre></div><h2 id="组件参数默认值配置"><a href="#组件参数默认值配置" aria-hidden="true" class="header-anchor">#</a> 组件参数默认值配置</h2> <p>注意：<code>SImage</code> 表示类名，与Taro UI 组件设计保持一致</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 默认值</span>
SImage<span class="token punctuation">.</span>defaultProps <span class="token operator">=</span> <span class="token punctuation">{</span>
    showAddBtn<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    multiple<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    length<span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
    <span class="token function-variable function">onSuccess</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="组件参数类型配置"><a href="#组件参数类型配置" aria-hidden="true" class="header-anchor">#</a> 组件参数类型配置</h2> <p>注意：先安装<code>npm install prop-types --save</code>插件</p> <div class="language-:js extra-class"><pre class="language-text"><code>// 参数类型检查
SImage.propTypes = {
    showAddBtn: PropTypes.bool,
    multiple: PropTypes.bool,
    length: PropTypes.number,
    onSuccess: PropTypes.func
  }

</code></pre></div><h2 id="组件统一入口配置"><a href="#组件统一入口配置" aria-hidden="true" class="header-anchor">#</a> 组件统一入口配置</h2> <p>注意：参考路径：<code>src/components.js</code>,自定义的所有组件都需要注册在这个文件，便于统一引用</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// eslint-disable-next-line import/prefer-default-export</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> <span class="token keyword">default</span> <span class="token keyword">as</span> SImage <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./components/upload/image'</span>
</code></pre></div><h2 id="组件自定义方法"><a href="#组件自定义方法" aria-hidden="true" class="header-anchor">#</a> 组件自定义方法</h2> <p>支持传参</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">onSuccess</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="使用自定义的组件"><a href="#使用自定义的组件" aria-hidden="true" class="header-anchor">#</a> 使用自定义的组件</h2> <p>使用方式同<code>Taro ui</code>组件一致</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 引用自定义组件</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> SImage <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../../components'</span>

<span class="token comment">// 调用组件里的自定义方法</span>
<span class="token function">onSuccess</span> <span class="token punctuation">(</span><span class="token parameter">files</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>files<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">render</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>View className<span class="token operator">=</span><span class="token string">'index'</span><span class="token operator">&gt;</span>
       <span class="token operator">&lt;</span>SImage onSuccess<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">onSuccess</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">}</span> multiple<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>SImage<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>View<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <!----> <!----> <!----> <div class="page-edit" data-v-cdcae5a4><!----> <div class="last-updated" data-v-cdcae5a4><span class="prefix" data-v-cdcae5a4>最后更新时间: </span> <span class="time" data-v-cdcae5a4>6/26/2019, 1:36:49 PM</span></div></div> <!----> </div> <div class="valine-wrapper" data-v-63f18ac0><div id="valine" style="display:;" data-v-63f18ac0></div></div> <!----> <!----> <div class="back-to-ceiling" style="right:1rem;bottom:3rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;background-color:rgba(231, 234, 241,.5);display:none;" data-v-41016a8b data-v-41016a8b><i class="iconfont reco-up" data-v-41016a8b></i></div></div></div></div>
    <script src="/blog-vuepress/assets/js/app.ed3613a2.js" defer></script><script src="/blog-vuepress/assets/js/24.2c8d5321.js" defer></script>
  </body>
</html>
